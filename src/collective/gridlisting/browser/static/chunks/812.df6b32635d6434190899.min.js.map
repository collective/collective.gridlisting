{"version":3,"file":"chunks/812.df6b32635d6434190899.min.js","mappings":"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","sources":["webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/dom.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/logging.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/registry.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/utils.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/parser.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/mockup-parser.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/core/base.js","webpack://collective.gridlisting/./node_modules/@patternslib/patternslib/src/pat/masonry/masonry.js"],"sourcesContent":["/* Utilities for DOM traversal or navigation */\nimport logging from \"./logging\";\n\nconst logger = logging.getLogger(\"core dom\");\n\nconst DATA_PREFIX = \"__patternslib__data_prefix__\";\nconst DATA_STYLE_DISPLAY = \"__patternslib__style__display\";\n\n/**\n * Return an array of DOM nodes.\n *\n * @param {Node|NodeList|jQuery} nodes - The DOM node to start the search from.\n *\n * @returns {Array} - An array of DOM nodes.\n */\nconst toNodeArray = (nodes) => {\n    if (nodes.jquery || nodes instanceof NodeList) {\n        // jQuery or document.querySelectorAll\n        nodes = [...nodes];\n    } else if (nodes instanceof Array === false) {\n        nodes = [nodes];\n    }\n    return nodes;\n};\n\n/**\n * Like querySelectorAll but including the element where it starts from.\n * Returns an Array, not a NodeList\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst querySelectorAllAndMe = (el, selector) => {\n    if (!el) {\n        return [];\n    }\n\n    const all = [...el.querySelectorAll(selector)];\n    if (el.matches(selector)) {\n        all.unshift(el); // start element should be first.\n    }\n    return all;\n};\n\n/**\n * Wrap a element with a wrapper element.\n *\n * The element to be wrapped will be moved into the wrapper element and the\n * wrapper element is placed just before the old element was.\n *\n * @param {Node} el - The DOM node to wrap.\n * @param {Node} wrapper - The wrapper element.\n */\nconst wrap = (el, wrapper) => {\n    // See: https://stackoverflow.com/a/13169465/1337474\n    el.parentNode.insertBefore(wrapper, el);\n    wrapper.appendChild(el);\n};\n\n/**\n * Hides the element with ``display: none`` and stores the current display value.\n *\n * @param {Node} el - The DOM node to hide.\n */\nconst hide = (el) => {\n    if (el.style.display === \"none\") {\n        // Nothing to do.\n        return;\n    }\n    if (el.style.display) {\n        el[DATA_STYLE_DISPLAY] = el.style.display;\n    }\n    el.style.display = \"none\";\n};\n\n/**\n * Shows element by removing ``display: none`` and restoring the display value\n * to whatever it was before.\n *\n * @param {Node} el - The DOM node to show.\n */\nconst show = (el) => {\n    const val = el[DATA_STYLE_DISPLAY] || null;\n    el.style.display = val;\n    delete el[DATA_STYLE_DISPLAY];\n};\n\n/**\n * Test, if a element is visible or not.\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is visible.\n */\nconst is_visible = (el) => {\n    // Check, if element is visible in DOM.\n    // https://stackoverflow.com/a/19808107/1337474\n    return el.offsetWidth > 0 && el.offsetHeight > 0;\n};\n\n/**\n * Test, if a element is a input-type element.\n *\n * This is taken from Sizzle/jQuery at:\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L139\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L1773\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is a input-type element.\n */\nconst is_input = (el) => {\n    const re_input = /^(?:input|select|textarea|button)$/i;\n    return re_input.test(el.nodeName);\n};\n\n/**\n * Return all direct parents of ``el`` matching ``selector``.\n * This matches against all parents but not the element itself.\n * The order of elements is from the search starting point up to higher\n * DOM levels.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - CSS selector to match against.\n * @returns {Array} - List of matching DOM nodes.\n */\nconst find_parents = (el, selector) => {\n    const ret = [];\n    let parent = el;\n    while (parent) {\n        parent = parent.parentNode?.closest?.(selector);\n        if (parent) ret.push(parent);\n    }\n    return ret;\n};\n\n/**\n * Find an element in the whole DOM tree if the selector is an ID selector,\n * otherwise use the given element as the starting point.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - The CSS selector to search for.\n *\n * @returns {NodeList} - The DOM nodes found.\n *\n */\nconst find_scoped = (el, selector) => {\n    // If the selector starts with an object id do a global search,\n    // otherwise do a local search.\n    return (selector.indexOf(\"#\") === 0 ? document : el).querySelectorAll(selector);\n};\n\n/**\n * Return all HTMLElement parents of el, starting from the direct parent of el.\n * The document itself is excluded because it's not a real DOM node.\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst get_parents = (el) => {\n    // Return all HTMLElement parents of el, starting from the direct parent of el.\n    const parents = [];\n    let parent = el?.parentNode;\n    while (parent) {\n        parents.push(parent);\n        parent = parent?.parentNode;\n        parent = parent instanceof HTMLElement ? parent : null;\n    }\n    return parents;\n};\n\n/**\n * Return the value of the first attribute found in the list of parents.\n *\n * @param {Node} el - The DOM element to start the acquisition search for the given attribute.\n * @param {string} attribute - Name of the attribute to search for.\n * @param {Boolean} include_empty - Also return empty values.\n * @param {Boolean} include_all - Return a list of attribute values found in all parents.\n *\n * @returns {*} - Returns the value of the searched attribute or a list of all attributes.\n */\nconst acquire_attribute = (\n    el,\n    attribute,\n    include_empty = false,\n    include_all = false\n) => {\n    let _el = el;\n    const ret = []; // array for ``include_all`` mode.\n    while (_el) {\n        const val = _el.getAttribute(attribute);\n        if (val || (include_empty && val === \"\")) {\n            if (!include_all) {\n                return val;\n            }\n            ret.push(val);\n        }\n        _el = _el.parentElement;\n    }\n    if (include_all) {\n        return ret;\n    }\n};\n\n/**\n * Return a DocumentFragment from a given string.\n *\n * @param {String} string - The HTML structure as a string.\n *\n * @returns {DocumentFragment} - The DOM nodes as a DocumentFragment.\n */\nconst create_from_string = (string) => {\n    // See: https://davidwalsh.name/convert-html-stings-dom-nodes\n    return document.createRange().createContextualFragment(string.trim());\n};\n\n/**\n * Return a CSS property value for a given DOM node.\n * For length-values, relative values are converted to pixels.\n * Optionally parse as pixels, if applicable.\n *\n * Note: The element must be attached to the body to make CSS caluclations work.\n *\n * @param {Node} el - DOM node.\n * @param {String} property - CSS property to query on DOM node.\n * @param {Boolean} [as_pixels=false] - Convert value to pixels, if applicable.\n * @param {Boolean} [as_float=false] - Convert value to float, if applicable.\n *\n * @returns {(String|Number)} - The CSS value to return.\n */\nfunction get_css_value(el, property, as_pixels = false, as_float = false) {\n    let value = window.getComputedStyle(el).getPropertyValue(property);\n    if (as_pixels || as_float) {\n        value = parseFloat(value) || 0.0;\n    }\n    if (as_pixels && !as_float) {\n        value = parseInt(Math.round(value), 10);\n    }\n    return value;\n}\n\n/**\n * Find a scrollable element up in the DOM tree.\n *\n * Note: Setting the ``overflow`` shorthand property also sets the individual overflow-y and overflow-y properties.\n *\n * @param {Node} el - The DOM element to start the search on.\n * @param {String} [direction=] - Not given: Search for any scrollable element up in the DOM tree.\n *                                ``x``: Search for a horizontally scrollable element.\n *                                ``y``: Search for a vertically scrollable element.\n * @param {(Node|null)} [fallback=document.body] - Fallback, if no scroll container can be found.\n *                                                     The default is to use document.body.\n *\n * @returns {Node} - Return the first scrollable element.\n *                   If no other element could be found, document.body would be returned.\n */\nconst find_scroll_container = (el, direction, fallback = document.body) => {\n    while (el && el !== document.body) {\n        if (!direction || direction === \"y\") {\n            let overflow_y = get_css_value(el, \"overflow-y\");\n            if ([\"auto\", \"scroll\"].includes(overflow_y)) {\n                return el;\n            }\n        }\n        if (!direction || direction === \"x\") {\n            let overflow_x = get_css_value(el, \"overflow-x\");\n            if ([\"auto\", \"scroll\"].includes(overflow_x)) {\n                return el;\n            }\n        }\n        el = el.parentElement;\n    }\n    return fallback;\n};\n\n/**\n * Get the horizontal scroll position.\n *\n * @param {Node} scroll_reference - The element to get the scroll position from.\n *\n * @returns {number} The horizontal scroll position.\n */\nconst get_scroll_x = (scroll_reference) => {\n    // scroll_listener == window: window.scrollX\n    // scroll_listener == html: html.scrollLeft == window.scrollX\n    // scroll_listener == DOM node: node.scrollLeft\n    return typeof scroll_reference.scrollLeft !== \"undefined\"\n        ? scroll_reference.scrollLeft\n        : scroll_reference.scrollX;\n};\n\n/**\n * Get the vertical scroll position.\n *\n * @param {Node} scroll_reference - The element to get the scroll position from.\n *\n * @returns {number} The vertical scroll position.\n */\nconst get_scroll_y = (scroll_reference) => {\n    // scroll_listener == window: window.scrollY\n    // scroll_listener == html: html.scrollTop == window.scrollY\n    // scroll_listener == DOM node: node.scrollTop\n    return typeof scroll_reference.scrollTop !== \"undefined\"\n        ? scroll_reference.scrollTop\n        : scroll_reference.scrollY;\n};\n\n/**\n * Get the elements position relative to another element.\n *\n * @param {Node} el - The DOM element to get the position for.\n * @param {Node} [reference_el=document.body] - The DOM element to get the position relative to.\n *\n * @returns {{top: number, left: number}} - The position of the element relative to the other element.\n */\nconst get_relative_position = (el, reference_el = document.body) => {\n    // Get the reference element to which against we calculate\n    // the relative position of the target.\n    // In case of a scroll container of window, we do not have\n    // getBoundingClientRect method, so get the body instead.\n    if (reference_el === window) {\n        reference_el = document.body;\n    }\n\n    // Calculate absolute [¹] position difference between\n    // scroll_container and scroll_target.\n    // Substract the container's border from the scrolling\n    // value, as this one isn't respected by\n    // getBoundingClientRect [²] and would lead to covered\n    // items [³].\n    // ¹) so that it doesn't make a difference, if the element\n    // is below or above the scrolling container. We just need\n    // to know the absolute difference.\n    // ²) Calculations are based from the viewport.\n    // ³) See:\n    //      https://docs.microsoft.com/en-us/previous-versions//hh781509(v=vs.85)\n    //      https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n    const left = Math.abs(\n        el.getBoundingClientRect().left +\n            reference_el.scrollLeft -\n            reference_el.getBoundingClientRect().left -\n            dom.get_css_value(reference_el, \"border-left-width\", true)\n    );\n    const top = Math.abs(\n        el.getBoundingClientRect().top +\n            reference_el.scrollTop -\n            reference_el.getBoundingClientRect().top -\n            dom.get_css_value(reference_el, \"border-top-width\", true)\n    );\n\n    return { top, left };\n};\n\n/**\n * Scroll to a given element.\n * The element will be scrolled to the top of the scroll container.\n *\n * @param {Node} el - The element which should be scrolled to.\n * @param {Node} scroll_container - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n * @param {string} [direction=\"top\"] - The direction to scroll to. Can be either \"top\", \"left\" or \"both\".\n */\nconst scroll_to_element = (el, scroll_container, offset = 0, direction = \"top\") => {\n    // Get the position of the element relative to the scroll container.\n    const position = get_relative_position(el, scroll_container);\n\n    const options = { behavior: \"auto\" };\n    if (direction === \"top\" || direction === \"both\") {\n        options.top = position.top - offset;\n    }\n    if (direction === \"left\" || direction === \"both\") {\n        options.left = position.left - offset;\n    }\n\n    // Scroll to the target position.\n    scroll_container.scrollTo(options);\n};\n\n/**\n * Scroll to the top of a scrolling container.\n *\n * @param {Node} [scroll_container = document.body] - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n */\nconst scroll_to_top = (scroll_container = document.body, offset = 0) => {\n    // Just scroll up, period.\n    scroll_container.scrollTo({ top: 0 - offset, behavior: \"auto\" });\n};\n\n/**\n * Scroll to the bottom of a scrolling container.\n *\n * @param {Node} [scroll_container = document.body] - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n */\nconst scroll_to_bottom = (scroll_container = document.body, offset = 0) => {\n    // Just scroll up, period.\n    //\n    const top = (scroll_container === window ? document.body : scroll_container)\n        .scrollHeight;\n    scroll_container.scrollTo({ top: top - offset, behavior: \"auto\" });\n};\n\n/**\n * Get data stored directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node from which we want to retrieve the data.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param default_value {Any} - Optional default value.\n * @returns {Any} - The value which is stored on the DOM node.\n */\nconst get_data = (el, name, default_value) => {\n    return el[`${DATA_PREFIX}${name}`] || default_value;\n};\n\n/**\n * Set and store data directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to store the data on.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param value {Any} - The value we want to store on the DOM node.\n */\nconst set_data = (el, name, value) => {\n    el[`${DATA_PREFIX}${name}`] = value;\n};\n\n/**\n * Delete a variable from the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to delete the variable from.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n */\nconst delete_data = (el, name) => {\n    delete el[`${DATA_PREFIX}${name}`];\n};\n\n/**\n * Simple template engine, based on JS template literal\n *\n * NOTE: This uses eval and would break if Content-Security-Policy does not\n *       allow 'unsafe-eval'.\n *       Because of this CSR problem the use of this method is not recommended.\n *\n * Please note: You cannot pass a template literal as template_string.\n * JavaScript itself would try to expand it and would fail.\n *\n * See: https://stackoverflow.com/a/37217166/1337474\n *\n * @param {String} template_string - The template string as a JavaScript template literal.\n *                                   For each variable in the template you have to use ``this``.\n *                                   E.g. if you pass ``{message: \"ok\"}`` as template_variables, you can use it like so:\n *                                   `<h1>${this.message}</h1>`\n * @param {Object} template_variables - Object literal with all the variables which should be used in the template.\n *\n * @returns {String} - Returns the a string as template expanded with the template_variables.\n */\nconst template = (template_string, template_variables = {}) => {\n    logger.warn(\n        \"Using dom.template is not recommended due to a problem with Content-Security-Policy.\"\n    );\n    return new Function(\"return `\" + template_string + \"`;\").call(template_variables);\n};\n\n/**\n * Get the visible ratio of an element compared to container.\n * If no container is given, the viewport is used.\n *\n * Note: currently only vertical ratio is supported.\n *\n * @param {Node} el - The element to get the visible ratio from.\n * @param {Node} [container] - The container to compare the element to.\n * @returns {number} - The visible ratio of the element.\n *                    0 means the element is not visible.\n *                    1 means the element is fully visible.\n */\nconst get_visible_ratio = (el, container) => {\n    if (!el) {\n        return 0;\n    }\n\n    const rect = el.getBoundingClientRect();\n    const container_rect =\n        container !== window\n            ? container.getBoundingClientRect()\n            : {\n                  top: 0,\n                  bottom: window.innerHeight,\n              };\n\n    let visible_ratio = 0;\n    if (rect.top < container_rect.bottom && rect.bottom > container_rect.top) {\n        const rect_height = rect.bottom - rect.top;\n        const visible_height =\n            Math.min(rect.bottom, container_rect.bottom) -\n            Math.max(rect.top, container_rect.top);\n        visible_ratio = visible_height / rect_height;\n    }\n\n    return visible_ratio;\n};\n\n/**\n * Get an escaped CSS selector for a given id string.\n *\n * id selectors should - but don't have to - start with a letter.\n * If the id starts with a number or a dash, it should be escaped.\n * This method does that for you.\n *\n * Alse see:\n * - https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/id\n * - https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape\n *\n * @param {String} id - The id to escape.\n *\n * @returns {String} - The escaped CSS selector.\n *\n * @example\n * escape_css_id_selector(\"#123\"); // returns \"#\\\\31 23\"\"\n * escape_css_id_selector(\"#-123\"); // returns \"#-\\\\31 23\"\n */\nconst escape_css_id = (id) => {\n    return `#${CSS.escape(id.split(\"#\")[1])}`;\n};\n\n/**\n * Get a universally unique id (uuid) for a DOM element.\n *\n * This method returns a uuid for the given element. On the first call it will\n * generate a uuid and store it on the element.\n *\n * @param {Node} el - The DOM node to get the uuid for.\n * @returns {String} - The uuid.\n */\nconst element_uuid = (el) => {\n    if (!get_data(el, \"uuid\", false)) {\n        let uuid;\n        if (window.crypto.randomUUID) {\n            // Create a real UUID\n            // window.crypto.randomUUID does only exist in browsers with secure\n            // context.\n            // See: https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID\n            uuid = window.crypto.randomUUID();\n        } else {\n            // Create a sufficiently unique ID\n            const array = new Uint32Array(4);\n            uuid = window.crypto.getRandomValues(array).join(\"\");\n        }\n        set_data(el, \"uuid\", uuid);\n    }\n    return get_data(el, \"uuid\");\n};\n\n/**\n * Find a related form element.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @returns {Node} - The closest form element.\n *\n * @example\n * find_form(document.querySelector(\"input\"));\n */\nconst find_form = (el) => {\n    // Prefer input.form which allows for input outside form elements and fall\n    // back to search for a parent form.\n    const form =\n        el.closest(\".pat-subform\") || // Special Patternslib subform concept has precedence.\n        el.form ||\n        el.querySelector(\"input, select, textarea, button\")?.form ||\n        el.closest(\"form\");\n    return form;\n};\n\nconst dom = {\n    toNodeArray: toNodeArray,\n    querySelectorAllAndMe: querySelectorAllAndMe,\n    wrap: wrap,\n    hide: hide,\n    show: show,\n    find_parents: find_parents,\n    find_scoped: find_scoped,\n    get_parents: get_parents,\n    acquire_attribute: acquire_attribute,\n    is_visible: is_visible,\n    is_input: is_input,\n    create_from_string: create_from_string,\n    get_css_value: get_css_value,\n    find_scroll_container: find_scroll_container,\n    get_scroll_x: get_scroll_x,\n    get_scroll_y: get_scroll_y,\n    get_relative_position: get_relative_position,\n    scroll_to_element: scroll_to_element,\n    scroll_to_top: scroll_to_top,\n    scroll_to_bottom: scroll_to_bottom,\n    get_data: get_data,\n    set_data: set_data,\n    delete_data: delete_data,\n    template: template,\n    get_visible_ratio: get_visible_ratio,\n    escape_css_id: escape_css_id,\n    element_uuid: element_uuid,\n    find_form: find_form,\n};\n\nexport default dom;\n","/**\n * Patterns logging - minimal logging framework\n *\n * Copyright 2012 Simplon B.V.\n */\n\n// source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind\nif (!Function.prototype.bind) {\n    Function.prototype.bind = function (oThis) {\n        if (typeof this !== \"function\") {\n            // closest thing possible to the ECMAScript 5 internal IsCallable function\n            throw new TypeError(\n                \"Function.prototype.bind - what is trying to be bound is not callable\"\n            );\n        }\n\n        var aArgs = Array.prototype.slice.call(arguments, 1),\n            fToBind = this,\n            fNOP = function () {},\n            fBound = function () {\n                return fToBind.apply(\n                    this instanceof fNOP && oThis ? this : oThis,\n                    aArgs.concat(Array.prototype.slice.call(arguments))\n                );\n            };\n        fNOP.prototype = this.prototype;\n        fBound.prototype = new fNOP();\n\n        return fBound;\n    };\n}\n\nvar root, // root logger instance\n    writer; // writer instance, used to output log entries\n\nvar Level = {\n    DEBUG: 10,\n    INFO: 20,\n    WARN: 30,\n    ERROR: 40,\n    FATAL: 50,\n};\n\nfunction ConsoleWriter() {}\n\nConsoleWriter.prototype = {\n    output: function (log_name, level, messages) {\n        if (log_name) messages.unshift(log_name + \":\");\n        if (level <= Level.DEBUG) {\n            // console.debug exists but is deprecated\n            messages.unshift(\"[DEBUG]\");\n            console.log.apply(console, messages);\n        } else if (level <= Level.INFO) console.info.apply(console, messages);\n        else if (level <= Level.WARN) console.warn.apply(console, messages);\n        else console.error.apply(console, messages);\n    },\n};\n\nfunction Logger(name, parent) {\n    this._loggers = {};\n    this.name = name || \"\";\n    this._parent = parent || null;\n    if (!parent) {\n        this._enabled = true;\n        this._level = Level.WARN;\n    }\n}\n\nLogger.prototype = {\n    getLogger: function (name) {\n        var path = name.split(\".\"),\n            root = this,\n            route = this.name ? [this.name] : [];\n        while (path.length) {\n            var entry = path.shift();\n            route.push(entry);\n            if (!(entry in root._loggers))\n                root._loggers[entry] = new Logger(route.join(\".\"), root);\n            root = root._loggers[entry];\n        }\n        return root;\n    },\n\n    _getFlag: function (flag) {\n        var context = this;\n        flag = \"_\" + flag;\n        while (context !== null) {\n            if (context[flag] !== undefined) return context[flag];\n            context = context._parent;\n        }\n        return null;\n    },\n\n    setEnabled: function (state) {\n        this._enabled = !!state;\n    },\n\n    isEnabled: function () {\n        this._getFlag(\"enabled\");\n    },\n\n    setLevel: function (level) {\n        if (typeof level === \"number\") this._level = level;\n        else if (typeof level === \"string\") {\n            level = level.toUpperCase();\n            if (level in Level) this._level = Level[level];\n        }\n    },\n\n    getLevel: function () {\n        return this._getFlag(\"level\");\n    },\n\n    log: function (level, messages) {\n        if (\n            !messages.length ||\n            !this._getFlag(\"enabled\") ||\n            level < this._getFlag(\"level\")\n        )\n            return;\n        messages = Array.prototype.slice.call(messages);\n        writer.output(this.name, level, messages);\n    },\n\n    debug: function () {\n        this.log(Level.DEBUG, arguments);\n    },\n\n    info: function () {\n        this.log(Level.INFO, arguments);\n    },\n\n    warn: function () {\n        this.log(Level.WARN, arguments);\n    },\n\n    error: function () {\n        this.log(Level.ERROR, arguments);\n    },\n\n    fatal: function () {\n        this.log(Level.FATAL, arguments);\n    },\n};\n\nfunction getWriter() {\n    return writer;\n}\n\nfunction setWriter(w) {\n    writer = w;\n}\n\nsetWriter(new ConsoleWriter());\n\nroot = new Logger();\n\nvar logconfig = /loglevel(|-[^=]+)=([^&]+)/g,\n    match;\n\nwhile ((match = logconfig.exec(window.location.search)) !== null) {\n    var logger = match[1] === \"\" ? root : root.getLogger(match[1].slice(1));\n    logger.setLevel(match[2].toUpperCase());\n}\n\nvar api = {\n    Level: Level,\n    getLogger: root.getLogger.bind(root),\n    setEnabled: root.setEnabled.bind(root),\n    isEnabled: root.isEnabled.bind(root),\n    setLevel: root.setLevel.bind(root),\n    getLevel: root.getLevel.bind(root),\n    debug: root.debug.bind(root),\n    info: root.info.bind(root),\n    warn: root.warn.bind(root),\n    error: root.error.bind(root),\n    fatal: root.fatal.bind(root),\n    getWriter: getWriter,\n    setWriter: setWriter,\n};\n\nexport default api;\n","/**\n * Patterns registry - Central registry and scan logic for patterns\n *\n * Copyright 2012-2013 Simplon B.V.\n * Copyright 2012-2013 Florian Friesdorf\n * Copyright 2013 Marko Durkovic\n * Copyright 2013 Rok Garbas\n * Copyright 2014-2015 Syslab.com GmBH, JC Brand\n */\n\n/*\n * changes to previous patterns.register/scan mechanism\n * - if you want initialised class, do it in init\n * - init returns set of elements actually initialised\n * - handle once within init\n * - no turnstile anymore\n * - set pattern.jquery_plugin if you want it\n */\nimport $ from \"jquery\";\nimport dom from \"./dom\";\nimport logging from \"./logging\";\nimport utils from \"./utils\";\n\nconst log = logging.getLogger(\"registry\");\nconst disable_re = /patterns-disable=([^&]+)/g;\nconst dont_catch_re = /patterns-dont-catch/g;\nconst disabled = {};\nlet dont_catch = false;\nlet match;\n\nwhile ((match = disable_re.exec(window.location.search)) !== null) {\n    disabled[match[1]] = true;\n    log.info(\"Pattern disabled via url config:\", match[1]);\n}\n\nwhile ((match = dont_catch_re.exec(window.location.search)) !== null) {\n    dont_catch = true;\n    log.info(\"I will not catch init exceptions\");\n}\n\n/**\n * Global pattern registry.\n *\n * This is a singleton and shared among any instance of the Patternslib\n * registry since Patternslib version 8.\n *\n * You normally don't need this as the registry handles it for you.\n */\nif (typeof window.__patternslib_registry === \"undefined\") {\n    window.__patternslib_registry = {};\n}\nexport const PATTERN_REGISTRY = window.__patternslib_registry;\nif (typeof window.__patternslib_registry_initialized === \"undefined\") {\n    window.__patternslib_registry_initialized = false;\n}\n\nconst registry = {\n    patterns: PATTERN_REGISTRY, // reference to global patterns registry\n    // as long as the registry is not initialized, pattern\n    // registration just registers a pattern. Once init is called,\n    // the DOM is scanned. After that registering a new pattern\n    // results in rescanning the DOM only for this pattern.\n    init() {\n        $(document).ready(function () {\n            if (window.__patternslib_registry_initialized) {\n                // Do not reinitialize a already initialized registry.\n                return;\n            }\n            window.__patternslib_registry_initialized = true;\n            log.debug(\"Loaded: \" + Object.keys(registry.patterns).sort().join(\", \"));\n            registry.scan(document.body);\n            log.debug(\"Finished initial scan.\");\n        });\n    },\n\n    clear() {\n        // Removes all patterns from the registry. Currently only being\n        // used in tests.\n        for (const name in registry.patterns) {\n            delete registry.patterns[name];\n        }\n    },\n\n    transformPattern(name, content) {\n        /* Call the transform method on the pattern with the given name, if\n         * it exists.\n         */\n        if (disabled[name]) {\n            log.debug(`Skipping disabled pattern: ${name}.`);\n            return;\n        }\n\n        const pattern = registry.patterns[name];\n        const transform = pattern.transform || pattern.prototype?.transform;\n        if (transform) {\n            try {\n                transform($(content));\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                log.error(`Transform error for pattern ${name}.`, e);\n            }\n        }\n    },\n\n    initPattern(name, el, trigger) {\n        /* Initialize the pattern with the provided name and in the context\n         * of the passed in DOM element.\n         */\n        const $el = $(el);\n        const pattern = registry.patterns[name];\n        const plog = logging.getLogger(`pat.${name}`);\n        if (el.matches(pattern.trigger)) {\n            plog.debug(\"Initialising.\", el);\n            try {\n                if (pattern.init) {\n                    // old style initialisation\n                    pattern.init($el, null, trigger);\n                } else {\n                    // class based pattern initialisation\n                    new pattern($el, null, trigger);\n                }\n\n                plog.debug(\"done.\");\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                plog.error(\"Caught error:\", e);\n            }\n        }\n    },\n\n    orderPatterns(patterns) {\n        // Always add pat-validation as first pattern, so that it can prevent\n        // other patterns from reacting to submit events if form validation\n        // fails.\n        if (patterns.includes(\"validation\")) {\n            patterns.splice(patterns.indexOf(\"validation\"), 1);\n            patterns.unshift(\"validation\");\n        }\n        // Add clone-code to the very beginning - we want to copy the markup\n        // before any other patterns changed the markup.\n        if (patterns.includes(\"clone-code\")) {\n            patterns.splice(patterns.indexOf(\"clone-code\"), 1);\n            patterns.unshift(\"clone-code\");\n        }\n\n        return patterns;\n    },\n\n    scan(content, patterns, trigger) {\n        if (!content) {\n            return;\n        }\n\n        if (typeof content === \"string\") {\n            content = document.querySelector(content);\n        } else if (content instanceof Text) {\n            // No need to scan a TextNode.\n            return;\n        } else if (content.jquery) {\n            content = content[0];\n        }\n\n        const selectors = [];\n        patterns = this.orderPatterns(patterns || Object.keys(registry.patterns));\n        for (const name of patterns) {\n            this.transformPattern(name, content);\n            const pattern = registry.patterns[name];\n            if (pattern.trigger) {\n                selectors.unshift(pattern.trigger);\n            }\n        }\n\n        let matches = dom.querySelectorAllAndMe(\n            content,\n            selectors.map((it) => it.trim().replace(/,$/, \"\")).join(\",\")\n        );\n        matches = matches.filter((el) => {\n            // Filter out patterns:\n            // - with class ``.disable-patterns``\n            // - wrapped in ``.disable-patterns`` elements\n            // - wrapped in ``<pre>`` elements\n            // - wrapped in ``<template>`` elements\n            return (\n                !el.matches(\".disable-patterns\") &&\n                !el?.parentNode?.closest?.(\".disable-patterns\") &&\n                !el?.parentNode?.closest?.(\"pre\") &&\n                !el?.parentNode?.closest?.(\"template\") && // NOTE: not strictly necessary. Template is a DocumentFragment and not reachable except for IE.\n                !el.matches(\".cant-touch-this\") && // BBB. TODO: Remove with next major version.\n                !el?.parentNode?.closest?.(\".cant-touch-this\") // BBB. TODO: Remove with next major version.\n            );\n        });\n\n        // walk list backwards and initialize patterns inside-out.\n        for (const el of matches.reverse()) {\n            for (const name of patterns) {\n                this.initPattern(name, el, trigger);\n            }\n        }\n        document.body.classList.add(\"patterns-loaded\");\n    },\n\n    register(pattern, name) {\n        name = name || pattern.name;\n        if (!name) {\n            log.error(\"Pattern lacks a name.\", pattern);\n            return false;\n        }\n        if (registry.patterns[name]) {\n            log.debug(`Already have a pattern called ${name}.`);\n            return false;\n        }\n        // register pattern to be used for scanning new content\n        registry.patterns[name] = pattern;\n\n        // register pattern as jquery plugin\n        if (pattern.jquery_plugin) {\n            const plugin_name = (\"pat-\" + name).replace(\n                /-([a-zA-Z])/g,\n                function (match, p1) {\n                    return p1.toUpperCase();\n                }\n            );\n            $.fn[plugin_name] = utils.jqueryPlugin(pattern);\n            // BBB 2012-12-10 and also for Mockup patterns.\n            $.fn[plugin_name.replace(/^pat/, \"pattern\")] = $.fn[plugin_name];\n        }\n        log.debug(`Registered pattern ${name}`, pattern);\n        if (window.__patternslib_registry_initialized) {\n            // Once the first initialization has been done, do only scan for\n            // newly registered patterns.\n            registry.scan(document.body, [name]);\n            log.debug(`Re-scanned dom with newly registered pattern ${name}.`);\n        }\n        return true;\n    },\n};\n\nexport default registry;\n","import $ from \"jquery\";\nimport dom from \"./dom\";\n\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24; // Milliseconds per day.\n\n$.fn.safeClone = function () {\n    var $clone = this.clone();\n    return $clone;\n};\n\n// Production steps of ECMA-262, Edition 5, 15.4.4.18\n// Reference: http://es5.github.io/#x15.4.4.18\nif (!Array.prototype.forEach) {\n    Array.prototype.forEach = function (callback, thisArg) {\n        var T, k;\n        if (this === null) {\n            throw new TypeError(\" this is null or not defined\");\n        }\n        // 1. Let O be the result of calling ToObject passing the |this| value as the argument.\n        var O = Object(this);\n        // 2. Let lenValue be the result of calling the Get internal method of O with the argument \"length\".\n        // 3. Let len be ToUint32(lenValue).\n        var len = O.length >>> 0;\n        // 4. If IsCallable(callback) is false, throw a TypeError exception.\n        // See: http://es5.github.com/#x9.11\n        if (typeof callback !== \"function\") {\n            throw new TypeError(callback + \" is not a function\");\n        }\n        // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.\n        if (arguments.length > 1) {\n            T = thisArg;\n        }\n        // 6. Let k be 0\n        k = 0;\n        // 7. Repeat, while k < len\n        while (k < len) {\n            var kValue;\n            // a. Let Pk be ToString(k).\n            //   This is implicit for LHS operands of the in operator\n            // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.\n            //   This step can be combined with c\n            // c. If kPresent is true, then\n            if (k in O) {\n                // i. Let kValue be the result of calling the Get internal method of O with argument Pk.\n                kValue = O[k];\n                // ii. Call the Call internal method of callback with T as the this value and\n                // argument list containing kValue, k, and O.\n                callback.call(T, kValue, k, O);\n            }\n            // d. Increase k by 1.\n            k++;\n        }\n        // 8. return undefined\n    };\n}\n\nvar singleBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR EACH\n     * matched element in the DOM.\n     *\n     * This is how the Mockup-type patterns behave. They are constructor\n     * functions which need to be invoked once per jQuery-wrapped DOM node\n     * for all DOM nodes on which the pattern applies.\n     */\n    var $this = this;\n    $this.each(function () {\n        var pat,\n            $el = $(this);\n        pat = pattern.init($el, options);\n        if (method) {\n            if (pat[method] === undefined) {\n                $.error(\n                    \"Method \" + method + \" does not exist on jQuery.\" + pattern.name\n                );\n                return false;\n            }\n            if (method.charAt(0) === \"_\") {\n                $.error(\"Method \" + method + \" is private on jQuery.\" + pattern.name);\n                return false;\n            }\n            pat[method].apply(pat, [options]);\n        }\n    });\n    return $this;\n};\n\nvar pluralBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR ALL\n     * matched elements in the DOM.\n     *\n     * This is how the vanilla Patternslib-type patterns behave. They are\n     * simple objects with an init method and this method gets called once\n     * with a list of jQuery-wrapped DOM nodes on which the pattern\n     * applies.\n     */\n    var $this = this;\n    if (method) {\n        if (pattern[method]) {\n            return pattern[method].apply($this, [$this].concat([options]));\n        } else {\n            $.error(\"Method \" + method + \" does not exist on jQuery.\" + pattern.name);\n        }\n    } else {\n        pattern.init.apply($this, [$this].concat([options]));\n    }\n    return $this;\n};\n\nvar jqueryPlugin = function (pattern) {\n    return function (method, options) {\n        var $this = this;\n        if ($this.length === 0) {\n            return $this;\n        }\n        if (typeof method === \"object\") {\n            options = method;\n            method = undefined;\n        }\n        if (typeof pattern === \"function\") {\n            return singleBoundJQueryPlugin.call(this, pattern, method, options);\n        } else {\n            return pluralBoundJQueryPlugin.call(this, pattern, method, options);\n        }\n    };\n};\n\n// Is a given variable an object?\nfunction isObject(obj) {\n    var type = typeof obj;\n    return type === \"function\" || (type === \"object\" && !!obj);\n}\n\n// Extend a given object with all the properties in passed-in object(s).\nfunction extend(obj) {\n    if (!isObject(obj)) return obj;\n    var source, prop;\n    for (var i = 1, length = arguments.length; i < length; i++) {\n        source = arguments[i];\n        for (prop in source) {\n            if (hasOwnProperty.call(source, prop)) {\n                obj[prop] = source[prop];\n            }\n        }\n    }\n    return obj;\n}\n// END: Taken from Underscore.js until here.\n\nfunction findLabel(input) {\n    var $label;\n    for (\n        var label = input.parentNode;\n        label && label.nodeType !== 11;\n        label = label.parentNode\n    ) {\n        if (label.tagName === \"LABEL\") {\n            return label;\n        }\n    }\n    if (input.id) {\n        $label = $('label[for=\"' + input.id + '\"]');\n    }\n    if ($label && $label.length === 0 && input.form) {\n        $label = $('label[for=\"' + input.name + '\"]', input.form);\n    }\n    if ($label && $label.length) {\n        return $label[0];\n    } else {\n        return null;\n    }\n}\n\n// Taken from http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escapeRegExp(str) {\n    return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n}\n\n/**\n * Create a RegExp object of a wildcard search string.\n *\n * @param {string} wildcard: A search string which can contain wildcards \"*\".\n *                           The wildcard \"*\" can be anywhere in the string and\n *                           can also be used multiple times. If no wildcard is\n *                           present the search string is used for an exact match.\n\n * @returns {RegExp}: A RegExp object which can be used to match strings.\n */\nfunction regexp_from_wildcard(wildcard) {\n    let regexp = wildcard.replace(/[\\-\\[\\]{}()+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\n    regexp = regexp.replace(/[*]/g, \".*\");\n    regexp = new RegExp(`^${regexp}$`);\n    return regexp;\n}\n\n/**\n * Remove classes from a list of targets if they match a specific pattern.\n *\n * @param {Node, NodeList} targets: Dom Node or NodeList where the classes should be removed.\n * @param {string} classes: String matching classes to be removed.\n *                          You can add a \"*\" as wildcard to search for classes to be removed.\n *                          E.g. \"icon-*-alert\" to remove any of \"icon-1-alert icon-2-alert\".\n *\n * @returns {undefined}: This method directly operates on the targets.\n */\nfunction removeWildcardClass(targets, classes) {\n    targets = utils.ensureArray(targets);\n\n    if (classes.indexOf(\"*\") === -1) {\n        for (const target of targets) {\n            target.classList.remove(classes);\n        }\n    } else {\n        const matcher = regexp_from_wildcard(classes);\n        for (const target of targets) {\n            const class_list = (target.getAttribute(\"class\") || \"\").split(/\\s+/);\n            if (!class_list.length) {\n                continue;\n            }\n            const ok = class_list.filter((it) => !matcher.test(it));\n            if (ok.length) {\n                target.setAttribute(\"class\", ok.join(\" \"));\n            } else {\n                target.removeAttribute(\"class\");\n            }\n        }\n    }\n}\n\nfunction hasValue(el) {\n    if (el.tagName === \"INPUT\") {\n        if (el.type === \"checkbox\" || el.type === \"radio\") {\n            return el.checked;\n        }\n        return el.value !== \"\";\n    }\n    if (el.tagName === \"SELECT\") {\n        return el.selectedIndex !== -1;\n    }\n    if (el.tagName === \"TEXTAREA\") {\n        return el.value !== \"\";\n    }\n    return false;\n}\n\nconst hideOrShow = (nodes, visible, options, pattern_name) => {\n    nodes = dom.toNodeArray(nodes);\n\n    const transitions = {\n        none: { hide: \"hide\", show: \"show\" },\n        fade: { hide: \"fadeOut\", show: \"fadeIn\" },\n        slide: { hide: \"slideUp\", show: \"slideDown\" },\n    };\n\n    const duration =\n        options.transition === \"css\" || options.transition === \"none\"\n            ? null\n            : options.effect.duration;\n\n    const on_complete = (el) => {\n        el.classList.remove(\"in-progress\");\n        el.classList.add(visible ? \"visible\" : \"hidden\");\n        $(el).trigger(\"pat-update\", {\n            pattern: pattern_name,\n            action: \"attribute-changed\",\n            dom: el,\n            transition: \"complete\",\n        });\n    };\n\n    for (const el of nodes) {\n        el.classList.remove(\"visible\");\n        el.classList.remove(\"hidden\");\n        el.classList.remove(\"in-progress\");\n\n        if (duration) {\n            const t = transitions[options.transition];\n            el.classList.add(\"in-progress\");\n            $(el).trigger(\"pat-update\", {\n                pattern: pattern_name,\n                action: \"attribute-changed\",\n                dom: el,\n                transition: \"start\",\n            });\n            $(el)[visible ? t.show : t.hide]({\n                duration: duration,\n                easing: options.effect.easing,\n                complete: () => on_complete(el),\n            });\n        } else {\n            if (options.transition !== \"css\") {\n                dom[visible ? \"show\" : \"hide\"](el);\n            }\n            on_complete(el);\n        }\n    }\n};\n\nfunction addURLQueryParameter(fullURL, param, value) {\n    /* Using a positive lookahead (?=\\=) to find the given parameter,\n     * preceded by a ? or &, and followed by a = with a value after\n     * than (using a non-greedy selector) and then followed by\n     * a & or the end of the string.\n     *\n     * Taken from http://stackoverflow.com/questions/7640270/adding-modify-query-string-get-variables-in-a-url-with-javascript\n     */\n    var val = new RegExp(\"(\\\\?|\\\\&)\" + param + \"=.*?(?=(&|$))\"),\n        parts = fullURL.toString().split(\"#\"),\n        url = parts[0],\n        hash = parts[1],\n        qstring = /\\?.+$/,\n        newURL = url;\n    // Check if the parameter exists\n    if (val.test(url)) {\n        // if it does, replace it, using the captured group\n        // to determine & or ? at the beginning\n        newURL = url.replace(val, \"$1\" + param + \"=\" + value);\n    } else if (qstring.test(url)) {\n        // otherwise, if there is a query string at all\n        // add the param to the end of it\n        newURL = url + \"&\" + param + \"=\" + value;\n    } else {\n        // if there's no query string, add one\n        newURL = url + \"?\" + param + \"=\" + value;\n    }\n    if (hash) {\n        newURL += \"#\" + hash;\n    }\n    return newURL;\n}\n\nfunction removeDuplicateObjects(objs) {\n    /* Given an array of objects, remove any duplicate objects which might\n     * be present.\n     */\n    const comparator = function (k, v) {\n        return this[k] === v;\n    };\n\n    return objs.reduce(function (list, next_obj) {\n        let is_duplicate = false;\n        for (const obj of list) {\n            is_duplicate =\n                Object.keys(obj).length === Object.keys(next_obj).length &&\n                Object.entries(obj).filter(\n                    (it) => !comparator.bind(next_obj)(it[0], it[1])\n                ).length === 0;\n        }\n        if (!is_duplicate) {\n            list.push(next_obj);\n        }\n        return list;\n    }, []);\n}\n\nfunction mergeStack(stack, length) {\n    /* Given a list of lists of objects (which for brevity we call a stack),\n     * return a list of objects where each object is the merge of all the\n     * corresponding original objects at that particular index.\n     *\n     * If a certain sub-list doesn't have an object at that particular\n     * index, the last object in that list is merged.\n     */\n    const results = [];\n    for (let i = 0; i < length; i++) {\n        results.push({});\n    }\n    for (const frame of stack) {\n        const frame_length = frame.length - 1;\n        for (let x = 0; x < length; x++) {\n            results[x] = $.extend(\n                results[x] || {},\n                frame[x > frame_length ? frame_length : x]\n            );\n        }\n    }\n    return results;\n}\n\nfunction isElementInViewport(el, partial = false, offset = 0) {\n    /* returns true if element is visible to the user ie. is in the viewport.\n     * Setting partial parameter to true, will only check if a part of the element is visible\n     * in the viewport, specifically that some part of that element is touching the top part\n     * of the viewport. This only applies to the vertical direction, ie. doesnt check partial\n     * visibility for horizontal scrolling\n     * some code taken from:\n     * http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433\n     */\n    if (el instanceof $) {\n        el = el[0];\n    }\n\n    const rec = el.getBoundingClientRect();\n    const rec_values = [rec.top, rec.bottom, rec.left, rec.right];\n\n    if (rec_values.every((val) => val === 0)) {\n        // if every property of rec is 0, the element is invisible;\n        return false;\n    } else if (partial) {\n        // when using getBoundingClientRect() (in the vertical case)\n        // negative means above top of viewport, positive means below top of viewport\n        // therefore for part of the element to be touching or crossing the top of the viewport\n        // rec.top must <= 0 and rec.bottom must >= 0\n        // an optional tolerance offset can be added for when the desired element is not exactly\n        // toucing the top of the viewport but needs to be considered as touching.\n        return (\n            rec.top <= 0 + offset && rec.bottom >= 0 + offset\n            //(rec.top >= 0+offset && rec.top <= window.innerHeight) // this checks if the element\n            // touches bottom part of viewport\n            // XXX do we want to include a check for the padding of an element?\n            // using window.getComputedStyle(target).paddingTop\n        );\n    } else {\n        // this will return true if the entire element is completely in the viewport\n        return (\n            rec.top >= 0 &&\n            rec.left >= 0 &&\n            rec.bottom <=\n                (window.innerHeight || document.documentElement.clientHeight) &&\n            rec.right <= (window.innerWidth || document.documentElement.clientWidth)\n        );\n    }\n}\n\n/* parseTime - Parse a duration from a string and return the parsed time in milliseconds.\n *\n * @param {String} time - A duration/time string like ``1ms``, ``1s`` or ``1m``.\n *\n * @returns {Number} - A integer which represents the parsed time in milliseconds.\n */\nfunction parseTime(time) {\n    var m = /^(\\d+(?:\\.\\d+)?)\\s*(\\w*)/.exec(time);\n    if (!m) {\n        throw new Error(\"Invalid time\");\n    }\n    var amount = parseFloat(m[1]);\n    switch (m[2]) {\n        case \"s\":\n            return Math.round(amount * 1000);\n        case \"m\":\n            return Math.round(amount * 1000 * 60);\n        case \"ms\":\n        default:\n            return Math.round(amount);\n    }\n}\n\n/*\n\n * parseLength - Parse a length from a string and return the parsed length in\n * pixels.\n\n * @param {String} length - A length string like `1px` or `25%`. Lengths without a unit are treated as pixels.\n * @param {Number} reference_length - The reference length to use for percentage lengths.\n *\n * @returns {Number} - A integer which represents the parsed length in pixels.\n *\n * @throws {Error} - If the length string is invalid.\n *\n * @example\n * parseLength(\"1px\"); // 1\n * parseLength(\"10%\", 100); // 10\n *\n */\nfunction parseLength(length, reference_length = null) {\n    const m = /^(\\d+(?:\\.\\d+)?)\\s*(\\%?\\w*)/.exec(length);\n    if (!m) {\n        throw new Error(\"Invalid length\");\n    }\n    const amount = parseFloat(m[1]);\n    switch (m[2]) {\n        case \"px\":\n            return Math.round(amount);\n        case \"%\":\n            if (!reference_length) {\n                return 0;\n            }\n            return (reference_length / 100) * Math.round(amount);\n        case \"vw\":\n            return Math.round((amount * window.innerWidth) / 100);\n        case \"vh\":\n            return Math.round((amount * window.innerHeight) / 100);\n        case \"vmin\":\n            return Math.round(\n                (amount * Math.min(window.innerWidth, window.innerHeight)) / 100\n            );\n        case \"vmax\":\n            return Math.round(\n                (amount * Math.max(window.innerWidth, window.innerHeight)) / 100\n            );\n        default:\n            return Math.round(amount);\n    }\n}\n\n// Return a jQuery object with elements related to an input element.\nfunction findRelatives(el) {\n    var $el = $(el),\n        $relatives = $(el),\n        $label = $();\n\n    $relatives = $relatives.add($el.closest(\"label\"));\n    $relatives = $relatives.add($el.closest(\"fieldset\"));\n\n    if (el.id) $label = $(\"label[for='\" + el.id + \"']\");\n    if (!$label.length) {\n        var $form = $el.closest(\"form\");\n        if (!$form.length) $form = $(document.body);\n        $label = $form.find(\"label[for='\" + el.name + \"']\");\n    }\n    $relatives = $relatives.add($label);\n    return $relatives;\n}\n\nfunction get_bounds(el) {\n    // Return bounds of an element with it's values rounded and converted to ints.\n    const bounds = el.getBoundingClientRect();\n    return {\n        x: parseInt(Math.round(bounds.x), 10) || 0,\n        y: parseInt(Math.round(bounds.y), 10) || 0,\n        top: parseInt(Math.round(bounds.top), 10) || 0,\n        bottom: parseInt(Math.round(bounds.bottom), 10) || 0,\n        left: parseInt(Math.round(bounds.left), 10) || 0,\n        right: parseInt(Math.round(bounds.right), 10) || 0,\n        width: parseInt(Math.round(bounds.width), 10) || 0,\n        height: parseInt(Math.round(bounds.height), 10) || 0,\n    };\n}\n\nfunction checkInputSupport(type, invalid_value) {\n    /* Check input type support.\n     *  See: https://stackoverflow.com/a/10199306/1337474\n     */\n    let support = false;\n    const input = document.createElement(\"input\");\n    input.setAttribute(\"type\", type);\n    support = input.type == type;\n\n    if (invalid_value !== undefined) {\n        // Check for input type UI support\n        input.setAttribute(\"value\", invalid_value);\n        support = input.value !== invalid_value;\n    }\n    return support;\n}\n\nconst checkCSSFeature = (attribute, value, tag = \"div\") => {\n    /* Check for browser support of specific CSS feature.\n     */\n    tag = document.createElement(tag);\n    let supported = tag.style[attribute] !== undefined;\n    if (supported && value !== undefined) {\n        tag.style[attribute] = value;\n        supported = tag.style[attribute] === value;\n    }\n    return supported;\n};\n\nconst animation_frame = () => {\n    // Return promise to await next repaint cycle\n    // Use it in your async function like so: ``await utils.animation_frame()``\n    // From: http://www.albertlobo.com/fractals/async-await-requestanimationframe-buddhabrot\n    return new Promise(window.requestAnimationFrame);\n};\n\nconst timeout = (ms) => {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds.\n * From: https://underscorejs.org/#debounce\n *\n * @param {Function} func - The function to debounce.\n * @param {Number} ms - The time in milliseconds to debounce.\n * @param {Object} timer - A module-global timer as an object.\n * @param {Boolean} [postpone=true] - If true, the function will only be called\n * at the end, after it stops being called for N milliseconds. If false, the\n * function will be called no more than each [ms] milliseconds, ensuring that\n * the function isn't postponed for for too long.\n *\n * @returns {Function} - The debounced function.\n */\nconst debounce = (func, ms, timer = { timer: null }, postpone = true) => {\n    // Returns a function, that, as long as it continues to be invoked, will not\n    // be triggered. The function will be called after it stops being called for\n    // N milliseconds.\n    // From: https://underscorejs.org/#debounce\n    //\n    // Make sure to initialize ``debounce`` only once per to-be-debounced\n    // function to not reinitialize the timer each time and debounce not being\n    // able to cancel previouse runs.\n    //\n    // Pass a module-global timer as an object ``{ timer: null }`` if you want\n    // to also cancel debounced functions from other pattern-invocations.\n    timer.last_run = 0;\n    return function () {\n        const args = arguments;\n        if (!postpone && timer.timer && Date.now() - timer.last_run <= ms) {\n            return;\n        }\n        clearTimeout(timer.timer);\n        timer.last_run = Date.now();\n        timer.timer = setTimeout(() => {\n            func.apply(this, args);\n        }, ms);\n    };\n};\n\nconst isIE = () => {\n    // See: https://stackoverflow.com/a/9851769/1337474\n    // Internet Explorer 6-11\n    return /*@cc_on!@*/ false || !!document.documentMode;\n};\n\nconst jqToNode = (el) => {\n    // Return a DOM node if a jQuery node was passed.\n    if (el.jquery) {\n        el = el[0];\n    }\n    return el;\n};\n\n/**\n * Always return an iterable object.\n *\n * @param {any} it: The object which needs to be wrapped in an array or returned as is if it is iterable.\n * @param {boolean} force_array: If the object is iterable but not an Array, convert it to an array (e.g. For jQuery items or NodeList objects).\n *\n * @returns {Array}: Returns the object wrapped in an Array, expanded to an Array or as-is if it is already iterable.\n */\nconst ensureArray = (it, force_array) => {\n    // Ensure to return always an array\n    const array_like = !!(\n        NodeList.prototype.isPrototypeOf(it) || // eslint-disable-line no-prototype-builtins\n        Array.isArray(it) ||\n        it.jquery\n    );\n    return array_like ? (force_array ? [...it] : it) : [it];\n};\n\nconst localized_isodate = (date) => {\n    // Return a iso date (date only) in the current timezone instead of a\n    // UTC ISO 8601 date+time component which toISOString returns.\n\n    const day = date.getDate().toString().padStart(2, \"0\");\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n    const year = date.getFullYear().toString();\n\n    return `${year}-${month}-${day}`;\n};\n\n/**\n * Replace HTML reserved characters with html entities to add HTML for user\n * editing to e.g. a textarea or a contenteditable.\n *\n * See:\n *  https://stackoverflow.com/a/22706073/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} html - The HTML string to encode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&`` will be replaced with ``&amp;``.\n *                     ``<`` will be repalced with ``&lt;``,\n *                     ``>`` will be replaced with ``&gt;``,\n *                     ``\"`` will be replaced with ``&quot;``.\n */\nconst escape_html = (html) => {\n    if (!html) {\n        return \"\";\n    }\n    const el = document.createElement(\"div\");\n    el.appendChild(document.createTextNode(html));\n    // Return escaped html and also replace quotes.\n    return el.innerHTML.replace(/\"/g, \"&quot;\");\n};\n\n/**\n * Return unescaped, raw HTML from an escaped HTML  string.\n *\n * See:\n *  https://stackoverflow.com/a/34064434/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} escaped_html - The HTML string to decode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&amp;`` will be replaced with ``&``,\n *                     ``&lt;`` will be repalced with ``<``,\n *                     ``&gt;`` will be replaced with ``>``,\n *                     ``&quot;`` will be replaced with ``\"``.\n */\nconst unescape_html = (escaped_html) => {\n    if (!escaped_html) {\n        return \"\";\n    }\n    const doc = new DOMParser().parseFromString(escaped_html, \"text/html\");\n    // Return unescaped html and also unescape quote named entities.\n    return doc.documentElement.textContent.replace(/&quot;/g, '\"');\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date/time string with or without an optional time component.\n *\n * @param {String} value - The date/time value to be checked.\n * @param {Boolean} [optional_time=false] - True, if time component is optional.\n * @return {Boolean} - True, if the given value is a valid Date string. False if not.\n */\nconst is_iso_date_time = (value, optional_time = false) => {\n    const re_date_time = optional_time\n        ? /^\\d{4}-[01]\\d-[0-3]\\d(T[0-2]\\d:[0-5]\\d)?$/\n        : /^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date string and without a time component.\n *\n * @param {String} value - The date value to be checked.\n * @return {Boolean} - True, if the given value is a valid ISO 8601 date string without a time component. False if not.\n */\nconst is_iso_date = (value) => {\n    const re_date_time = /^\\d{4}-[01]\\d-[0-3]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return the number of days between two dates.\n * Based on: https://stackoverflow.com/a/15289883/1337474\n *\n * @param {Date} date_1 - First date to compare. We will substract date_2 from date_1.\n * @param {Date} date_2 - Second date to compare.\n * @return {Number} - The number of days between the two dates.\n */\nconst date_diff = (date_1, date_2) => {\n    // Discard the time and time-zone information.\n    const utc_1 = Date.UTC(date_1.getFullYear(), date_1.getMonth(), date_1.getDate());\n    const utc_2 = Date.UTC(date_2.getFullYear(), date_2.getMonth(), date_2.getDate());\n\n    return Math.floor((utc_1 - utc_2) / _MS_PER_DAY);\n};\n\n/**\n * Build intersection observer threshold list.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#building_the_array_of_threshold_ratios\n *\n * @param {Number} num_steps - The number of steps to use.\n *\n * @returns {Array} - Returns the threshold list.\n */\nconst threshold_list = (num_steps = 0) => {\n    let thresholds = [];\n\n    for (let i = 1.0; i <= num_steps; i++) {\n        thresholds.push(i / num_steps);\n    }\n    thresholds.push(0);\n    return thresholds.sort();\n};\n\n/**\n * is_option_truthy - Check if an Pattern option is set.\n *\n * An option is set if it is not one of:\n * - undefined\n * - null\n * - \"none\"\n * - \"\"\n *\n * @param {String} option - The option to check.\n *\n * @returns {Boolean} - Returns true if the option is set, false otherwise.\n *\n * @example\n *\n * is_option_truthy() // false\n * is_option_truthy(undefined) // false\n * is_option_truthy(null) // false\n * is_option_truthy(\"\") // false\n * is_option_truthy(\"none\") // false\n * is_option_truthy(\"false\") // false\n * is_option_truthy(\"foo\") // true\n * is_option_truthy(true) // true\n * is_option_truthy(0) // true\n *\n */\nconst is_option_truthy = (option) => {\n    return ![undefined, null, \"none\", false, \"false\", \"\"].includes(option);\n};\n\nvar utils = {\n    jqueryPlugin: jqueryPlugin,\n    escapeRegExp: escapeRegExp,\n    isObject: isObject,\n    extend: extend,\n    findLabel: findLabel,\n    regexp_from_wildcard: regexp_from_wildcard,\n    removeWildcardClass: removeWildcardClass,\n    hideOrShow: hideOrShow,\n    addURLQueryParameter: addURLQueryParameter,\n    removeDuplicateObjects: removeDuplicateObjects,\n    mergeStack: mergeStack,\n    isElementInViewport: isElementInViewport,\n    hasValue: hasValue,\n    parseTime: parseTime,\n    parseLength: parseLength,\n    findRelatives: findRelatives,\n    get_bounds: get_bounds,\n    checkInputSupport: checkInputSupport,\n    checkCSSFeature: checkCSSFeature,\n    animation_frame: animation_frame,\n    timeout: timeout,\n    debounce: debounce,\n    isIE: isIE,\n    jqToNode: jqToNode,\n    ensureArray: ensureArray,\n    localized_isodate: localized_isodate,\n    escape_html: escape_html,\n    unescape_html: unescape_html,\n    is_iso_date_time: is_iso_date_time,\n    is_iso_date: is_iso_date,\n    date_diff: date_diff,\n    threshold_list: threshold_list,\n    is_option_truthy: is_option_truthy,\n    //getCSSValue: dom.get_css_value, // BBB: moved to dom. TODO: Remove in upcoming version.\n    elementInViewport: (el) => {\n        // BBB: Remove with next major version.\n        console.warn(\"Deprecated. Use utils.isElementInViewport\");\n        return isElementInViewport(el);\n    },\n};\n\nexport default utils;\n","// Patterns argument parser\nimport $ from \"jquery\";\nimport utils from \"./utils.js\";\nimport logging from \"./logging\";\n\nclass ArgumentParser {\n    constructor(name) {\n        this.order = [];\n        this.parameters = {};\n        this.attribute = \"data-pat-\" + name;\n        this.enum_values = {};\n        this.enum_conflicts = [];\n        this.groups = {};\n        this.possible_groups = {};\n        this.log = logging.getLogger(name + \".parser\");\n\n        this.group_pattern = /([a-z][a-z0-9]*)-([A-Z][a-z0-0\\-]*)/i;\n        this.json_param_pattern = /^\\s*\\[?\\s*{/i;\n        this.named_param_pattern = /^\\s*([a-z][a-z0-9\\-]*)\\s*:(.*)/is;\n        this.token_pattern = /(([\"']).*?(?!\\\\)\\2)|\\s*(\\S+)\\s*/g;\n    }\n\n    _camelCase(str) {\n        return str.replace(/\\-([a-z])/g, (__, p1) => p1.toUpperCase());\n    }\n\n    addAlias(alias, original) {\n        /* Add an alias for a previously added parser argument.\n         *\n         * Useful when you want to support both US and UK english argument\n         * names.\n         */\n        if (this.parameters[original]) {\n            this.parameters[original].alias = alias;\n        } else {\n            throw `Attempted to add an alias \"${alias}\" for a non-existing parser argument \"${original}\".`;\n        }\n    }\n\n    addGroupToSpec(spec) {\n        /* Determine wether an argument being parsed can be grouped and\n         * update its specifications object accordingly.\n         *\n         * Internal method used by addArgument and addJSONArgument\n         */\n        const m = spec.name.match(this.group_pattern);\n        if (m) {\n            const group = m[1];\n            const field = m[2];\n            if (group in this.possible_groups) {\n                const first_spec = this.possible_groups[group];\n                const first_name = first_spec.name.match(this.group_pattern)[2];\n                first_spec.group = group;\n                first_spec.dest = first_name;\n                this.groups[group] = new ArgumentParser();\n                this.groups[group].addArgument(\n                    first_name,\n                    first_spec.value,\n                    first_spec.choices,\n                    first_spec.multiple\n                );\n                delete this.possible_groups[group];\n            }\n            if (group in this.groups) {\n                this.groups[group].addArgument(\n                    field,\n                    spec.value,\n                    spec.choices,\n                    spec.multiple\n                );\n                spec.group = group;\n                spec.dest = field;\n            } else {\n                this.possible_groups[group] = spec;\n                spec.dest = this._camelCase(spec.name);\n            }\n        }\n        return spec;\n    }\n\n    addJSONArgument(name, default_value) {\n        /* Add an argument where the value is provided in JSON format.\n         *\n         * This is a different usecase than specifying all arguments to\n         * the data-pat-... attributes in JSON format, and instead is part\n         * of the normal notation except that a value is in JSON instead of\n         * for example a string.\n         */\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec({\n            name: name,\n            value: default_value,\n            dest: name,\n            group: null,\n            type: \"json\",\n        });\n    }\n\n    addArgument(name, default_value, choices, multiple) {\n        const spec = {\n            name: name,\n            value:\n                multiple && !Array.isArray(default_value)\n                    ? [default_value]\n                    : default_value,\n            multiple: multiple,\n            dest: name,\n            group: null,\n        };\n        if (choices && Array.isArray(choices) && choices.length) {\n            spec.choices = choices;\n            spec.type = this._typeof(choices[0]);\n            for (const choice of choices) {\n                if (this.enum_conflicts.indexOf(choice) !== -1) {\n                    continue;\n                } else if (choice in this.enum_values) {\n                    this.enum_conflicts.push(choice);\n                    delete this.enum_values[choice];\n                } else {\n                    this.enum_values[choice] = name;\n                }\n            }\n        } else if (typeof spec.value === \"string\" && spec.value.slice(0, 1) === \"$\") {\n            spec.type = this.parameters[spec.value.slice(1)].type;\n        } else {\n            // Note that this will get reset by _defaults if default_value is a function.\n            spec.type = this._typeof(multiple ? spec.value[0] : spec.value);\n        }\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec(spec);\n    }\n\n    _typeof(obj) {\n        if (obj === null) {\n            return \"null\";\n        }\n        return typeof obj;\n    }\n\n    _coerce(name, value) {\n        const spec = this.parameters[name];\n        if (typeof value !== spec.type)\n            try {\n                switch (spec.type) {\n                    case \"json\":\n                        value = JSON.parse(value);\n                        break;\n                    case \"boolean\":\n                        if (typeof value === \"string\") {\n                            value = value.toLowerCase();\n                            const num = parseInt(value, 10);\n                            if (!isNaN(num)) value = !!num;\n                            else\n                                value =\n                                    value === \"true\" ||\n                                    value === \"y\" ||\n                                    value === \"yes\" ||\n                                    value === \"y\" ||\n                                    value === \"on\";\n                        } else if (typeof value === \"number\") {\n                            value = !!value;\n                        } else {\n                            throw `Cannot convert value for ${name} to boolean.`;\n                        }\n                        break;\n                    case \"number\":\n                        if (typeof value === \"string\") {\n                            value = parseInt(value, 10);\n                            if (isNaN(value)) {\n                                throw `Cannot convert value for ${name} to number.`;\n                            }\n                        } else if (typeof value === \"boolean\") {\n                            value = value + 0;\n                        } else {\n                            throw `Cannot convert value for ${name} to number.`;\n                        }\n                        break;\n                    case \"string\":\n                        value = value.toString();\n                        break;\n                    case \"null\": // Missing default values\n                    case \"undefined\":\n                        break;\n                    default:\n                        throw `Do not know how to convert value for ${name} of type ${typeof value} to ${\n                            spec.type\n                        }.`;\n                }\n            } catch (e) {\n                this.log.warn(e);\n                return null;\n            }\n\n        if (spec.choices && spec.choices.indexOf(value) === -1) {\n            this.log.warn(`Illegal value for ${name}: ${value}.`);\n            return null;\n        }\n        return value;\n    }\n\n    _set(opts, name, value) {\n        if (!(name in this.parameters)) {\n            this.log.debug(`Ignoring value for unknown argument: ${name}.`);\n            return;\n        }\n        const spec = this.parameters[name];\n        let parts;\n        if (spec.multiple) {\n            if (typeof value === \"string\") {\n                parts = value.split(/,+/);\n            } else {\n                parts = value;\n            }\n            value = [];\n            for (const part of parts) {\n                const v = this._coerce(name, part.trim());\n                if (v !== null) {\n                    value.push(v);\n                }\n            }\n        } else {\n            value = this._coerce(name, value);\n            if (value === null) {\n                return;\n            }\n        }\n        opts[name] = value;\n    }\n\n    _split(text) {\n        const tokens = [];\n        text.replace(this.token_pattern, (match, quoted, __, simple) => {\n            if (quoted) {\n                tokens.push(quoted);\n            } else if (simple) {\n                tokens.push(simple);\n            }\n        });\n        return tokens;\n    }\n\n    _parseExtendedNotation(argstring) {\n        const opts = {};\n        const parts = argstring\n            .replace(/;;/g, \"\\0x1f\")\n            .replace(/&amp;/g, \"&amp\\0x1f\")\n            .split(/;/)\n            .map((el) => el.replace(new RegExp(\"\\0x1f\", \"g\"), \";\"));\n        for (const part of parts) {\n            if (!part) {\n                continue;\n            }\n            const matches = part.match(this.named_param_pattern);\n            if (!matches) {\n                this.log.warn(`Invalid parameter: ${part}: ${argstring}.`);\n                continue;\n            }\n            const name = matches[1];\n            const value = matches[2].trim();\n            const arg = Object.values(this.parameters).filter((it) => it.alias === name);\n\n            const is_alias = arg.length === 1;\n\n            if (is_alias) {\n                this._set(opts, arg[0].name, value);\n            } else if (name in this.parameters) {\n                this._set(opts, name, value);\n            } else if (name in this.groups) {\n                const subopt = this.groups[name]._parseShorthandNotation(value);\n                for (const field in subopt) {\n                    this._set(opts, name + \"-\" + field, subopt[field]);\n                }\n            } else {\n                this.log.warn(`Unknown named parameter: ${matches[1]}.`);\n                continue;\n            }\n        }\n        return opts;\n    }\n\n    _parseShorthandNotation(parameter) {\n        const parts = this._split(parameter);\n        const opts = {};\n        let i = 0;\n\n        while (parts.length) {\n            const part = parts.shift().trim();\n            let sense;\n            let flag;\n            let positional = true;\n            if (part.slice(0, 3) === \"no-\") {\n                sense = false;\n                flag = part.slice(3);\n            } else {\n                sense = true;\n                flag = part;\n            }\n            if (flag in this.parameters && this.parameters[flag].type === \"boolean\") {\n                positional = false;\n                this._set(opts, flag, sense);\n            } else if (flag in this.enum_values) {\n                positional = false;\n                this._set(opts, this.enum_values[flag], flag);\n            } else if (positional) this._set(opts, this.order[i], part);\n            else {\n                parts.unshift(part);\n                break;\n            }\n            i++;\n            if (i >= this.order.length) {\n                break;\n            }\n        }\n        if (parts.length) this.log.warn(`Ignore extra arguments: ${parts.join(\" \")}.`);\n        return opts;\n    }\n\n    _parse(parameter) {\n        if (!parameter) {\n            return {};\n        }\n        if (parameter.match(this.json_param_pattern)) {\n            try {\n                return JSON.parse(parameter);\n            } catch (e) {\n                this.log.warn(`Invalid JSON argument found: ${parameter}.`);\n            }\n        }\n        if (parameter.match(this.named_param_pattern)) {\n            return this._parseExtendedNotation(parameter);\n        }\n        const sep = parameter.indexOf(\";\");\n        if (sep === -1) {\n            return this._parseShorthandNotation(parameter);\n        }\n        const opts = this._parseShorthandNotation(parameter.slice(0, sep));\n        const extended = this._parseExtendedNotation(parameter.slice(sep + 1));\n        for (const name in extended) {\n            opts[name] = extended[name];\n        }\n        return opts;\n    }\n\n    _defaults($el) {\n        const result = {};\n        for (const name in this.parameters) {\n            if (typeof this.parameters[name].value === \"function\") {\n                try {\n                    result[name] = this.parameters[name].value($el, name);\n                    this.parameters[name].type = typeof result[name];\n                } catch (e) {\n                    this.log.error(`Default function for ${name} failed.`);\n                }\n            } else {\n                result[name] = this.parameters[name].value;\n            }\n        }\n        return result;\n    }\n\n    _cleanupOptions(options, group_options = true) {\n        // Resolve references\n        for (const name of Object.keys(options)) {\n            const spec = this.parameters[name];\n            if (spec === undefined) {\n                continue;\n            }\n\n            if (\n                options[name] === spec.value &&\n                typeof spec.value === \"string\" &&\n                spec.value.slice(0, 1) === \"$\"\n            ) {\n                options[name] = options[spec.value.slice(1)];\n            }\n        }\n        if (group_options) {\n            // Move options into groups and do renames\n            for (const name of Object.keys(options)) {\n                const spec = this.parameters[name];\n                let target;\n                if (spec === undefined) {\n                    continue;\n                }\n\n                if (spec.group) {\n                    if (typeof options[spec.group] !== \"object\") {\n                        options[spec.group] = {};\n                    }\n                    target = options[spec.group];\n                } else {\n                    target = options;\n                }\n\n                if (spec.dest !== name) {\n                    target[spec.dest] = options[name];\n                    delete options[name];\n                }\n            }\n        }\n        return options;\n    }\n\n    parse($el, options, multiple, inherit = true, group_options = true) {\n        if (!$el.jquery) {\n            $el = $($el);\n        }\n        if (typeof options === \"boolean\" && multiple === undefined) {\n            // Fix argument order: ``multiple`` passed instead of ``options``.\n            multiple = options;\n            options = {};\n        }\n        const stack = inherit ? [[this._defaults($el)]] : [[{}]];\n        let $possible_config_providers;\n        let final_length = 1;\n        /*\n         * XXX this is a workaround for:\n         * - https://github.com/Patternslib/Patterns/issues/393\n         *\n         * Prevents the parser to pollute the pat-modal configuration\n         * with data-pat-inject elements define in a `.pat-modal` parent element.\n         *\n         *  Probably this function should be completely revisited, see:\n         * - https://github.com/Patternslib/Patterns/issues/627\n         *\n         */\n        if (\n            !inherit ||\n            ($el.hasClass(\"pat-modal\") && this.attribute === \"data-pat-inject\")\n        ) {\n            $possible_config_providers = $el;\n        } else {\n            $possible_config_providers = $el.parents(`[${this.attribute}]`).addBack();\n        }\n\n        for (const provider of $possible_config_providers) {\n            let frame;\n            const data = ($(provider).attr(this.attribute) || \"\").trim();\n            if (!data) {\n                continue;\n            }\n            const _parse = this._parse.bind(this);\n            if (data.match(/&&/)) {\n                frame = data.split(/\\s*&&\\s*/).map(_parse);\n            } else {\n                frame = _parse(data);\n            }\n            if (!Array.isArray(frame)) {\n                frame = [frame];\n            }\n            final_length = Math.max(frame.length, final_length);\n            stack.push(frame);\n        }\n\n        if (typeof options === \"object\") {\n            if (Array.isArray(options)) {\n                stack.push(options);\n                final_length = Math.max(options.length, final_length);\n            } else {\n                stack.push([options]);\n            }\n        }\n        if (!multiple) {\n            final_length = 1;\n        }\n        const results = utils\n            .removeDuplicateObjects(utils.mergeStack(stack, final_length))\n            .map((current_value) => this._cleanupOptions(current_value, group_options));\n        return multiple ? results : results[0];\n    }\n}\n\n// BBB\nArgumentParser.prototype.add_argument = ArgumentParser.prototype.addArgument;\n\nexport default ArgumentParser;\n","import $ from \"jquery\";\n\nvar parser = {\n    getOptions($el, patternName, options) {\n        /* This is the Mockup parser. An alternative parser for Patternslib\n         * patterns.\n         *\n         * NOTE: Use of the Mockup parser is discouraged and is added here for\n         * legacy support for the Plone Mockup project.\n         *\n         * It parses a DOM element for pattern configuration options.\n         */\n        options = options || {};\n        // get options from parent element first, stop if element tag name is 'body'\n        if ($el.length !== 0 && !$.nodeName($el[0], \"body\")) {\n            options = this.getOptions($el.parent(), patternName, options);\n        }\n        // collect all options from element\n        let elOptions = {};\n        if ($el.length !== 0) {\n            elOptions = $el.data(\"pat-\" + patternName);\n            if (elOptions) {\n                // parse options if string\n                if (typeof elOptions === \"string\") {\n                    const tmpOptions = {};\n                    $.each(elOptions.split(\";\"), function (i, item) {\n                        item = item.split(\":\");\n                        item.reverse();\n                        let key = item.pop();\n                        key = key.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        item.reverse();\n                        let value = item.join(\":\");\n                        value = value.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        tmpOptions[key] = value;\n                    });\n                    elOptions = tmpOptions;\n                }\n            }\n        }\n        return $.extend(true, {}, options, elOptions);\n    },\n};\n\nexport default parser;\n","/**\n * A Base pattern for creating scoped patterns. It's similar to Backbone's\n * Model class. The advantage of this approach is that each instance of a\n * pattern has its own local scope (closure).\n *\n * A new instance is created for each DOM element on which a pattern applies.\n *\n * You can assign values, such as $el, to `this` for an instance and they\n * will remain unique to that instance.\n *\n * Older Patternslib patterns on the other hand have a single global scope for\n * all DOM elements.\n */\nimport $ from \"jquery\";\nimport Registry from \"./registry\";\nimport logging from \"./logging\";\nimport mockupParser from \"./mockup-parser\";\n\nconst log = logging.getLogger(\"Patternslib Base\");\n\nconst initBasePattern = function ($el, options, trigger) {\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    const name = this.prototype.name;\n    const plog = logging.getLogger(`pat.${name}`);\n    let pattern = $el.data(`pattern-${name}`);\n    if (pattern === undefined && Registry.patterns[name]) {\n        try {\n            // Immediately set the pattern instance to the temporary value\n            // ``initializing`` before the async Base constructor is setting\n            // the value later.\n            // This prevents re-init the pattern on this element on multiple\n            // initialization calls..\n            $el.data(`pattern-${name}`, \"initializing\");\n            options =\n                this.prototype.parser === \"mockup\"\n                    ? mockupParser.getOptions($el, name, options)\n                    : options;\n            pattern = new Registry.patterns[name]($el, options, trigger);\n        } catch (e) {\n            plog.error(`Failed while initializing ${name} pattern.`, e);\n        }\n    }\n    return pattern;\n};\n\nconst Base = async function ($el, options, trigger) {\n    if (($el?.jquery && $el.length === 0) || !$el) {\n        log.warn(\"No element given to pattern.\");\n        return;\n    }\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    this.$el = $el;\n    this.el = $el[0];\n    this.options = $.extend(true, {}, this.defaults || {}, options || {});\n\n    this.emit(\"pre-init\");\n\n    await this.init($el, options, trigger);\n\n    // Store pattern instance on element\n    this.$el.data(`pattern-${this.name}`, this);\n    this.el[`pattern-${this.name}`] = this;\n\n    this.emit(\"init\");\n};\n\nBase.prototype = {\n    constructor: Base,\n    on(eventName, eventCallback) {\n        this.$el.on(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    one(eventName, eventCallback) {\n        this.$el.one(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    emit(eventName, args) {\n        // args should be a list\n        if (args === undefined) {\n            args = [];\n        }\n        this.$el.trigger(`${eventName}.${this.name}.patterns`, args);\n    },\n};\n\nBase.extend = function (patternProps) {\n    /* Helper function to correctly set up the prototype chain for new patterns.\n     */\n    const parent = this;\n    let child;\n\n    // Check that the required configuration properties are given.\n    if (!patternProps) {\n        throw new Error(\n            \"Pattern configuration properties required when calling Base.extend\"\n        );\n    }\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (Object.hasOwnProperty.call(patternProps, \"constructor\")) {\n        child = patternProps.constructor;\n    } else {\n        child = function () {\n            parent.apply(this, arguments);\n        };\n    }\n\n    // Allow patterns to be extended indefinitely\n    child.extend = Base.extend;\n\n    // Static properties required by the Patternslib registry\n    child.init = initBasePattern;\n    child.jquery_plugin = true;\n    child.trigger = patternProps.trigger;\n    child.parser = patternProps?.parser || null;\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () {\n        this.constructor = child;\n    };\n    Surrogate.prototype = parent.prototype;\n    child.prototype = new Surrogate();\n\n    // Add pattern's configuration properties (instance properties) to the subclass,\n    $.extend(true, child.prototype, patternProps);\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = parent.prototype;\n\n    // Register the pattern in the Patternslib registry.\n    if (!patternProps.name) {\n        log.warn(\"This pattern without a name attribute will not be registered!\");\n    } else if (!patternProps.trigger) {\n        log.warn(\n            `The pattern ${patternProps.name} does not have a trigger attribute, it will not be registered.`\n        );\n    } else if (patternProps.autoregister !== false) {\n        Registry.register(child, patternProps.name);\n    }\n    return child;\n};\n\nexport default Base;\n","/**\n * Patternslib pattern for Masonry\n * Copyright 2015 Syslab.com GmBH\n */\nimport $ from \"jquery\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport Base from \"../../core/base\";\nimport utils from \"../../core/utils\";\n\n// Lazy loading modules.\nlet Masonry;\n\nconst log = logging.getLogger(\"pat.masonry\");\n\nexport const parser = new Parser(\"masonry\");\n// parser.addArgument(\"stagger\", \"\");\nparser.addArgument(\"column-width\");\nparser.addArgument(\"container-style\", '{ \"position\": \"relative\" }');\nparser.addArgument(\"gutter\");\nparser.addArgument(\"is-fit-width\", false);\nparser.addArgument(\"is-horizontal-order\", false); // preserve horizontal order.\nparser.addArgument(\"is-origin-left\", true);\nparser.addArgument(\"is-origin-top\", true);\nparser.addArgument(\"is-percent-position\", false); // set item positions in percent values. items will not transition on resize.\nparser.addArgument(\"is-resize\", true); // adjust sizes and position on resize.\nparser.addArgument(\"item-selector\", \".item\");\nparser.addArgument(\"stamp\", \"\");\nparser.addArgument(\"transition-duration\", \"0.4s\");\n\n// is-* are masonry v3 options, here we add v4 style names.\n// we keep the is-* as there is special support with options parsing.\nparser.addAlias(\"fit-width\", \"is-fit-width\");\nparser.addAlias(\"origin-left\", \"is-origin-left\");\nparser.addAlias(\"origin-top\", \"is-origin-top\");\nparser.addAlias(\"horizontal-order\", \"is-horizontal-order\");\nparser.addAlias(\"percent-position\", \"is-percent-position\");\nparser.addAlias(\"resize\", \"is-resize\");\n\nexport default Base.extend({\n    name: \"masonry\",\n    trigger: \".pat-masonry\",\n\n    async init($el, opts) {\n        Masonry = (await import(\"masonry-layout\")).default;\n        const ImagesLoaded = (await import(\"imagesloaded\")).default;\n\n        this.options = parser.parse(this.$el, opts);\n        // Initialize\n        this.initMasonry();\n\n        const imgLoad = await ImagesLoaded(this.$el);\n        imgLoad.on(\n            \"progress\",\n            function () {\n                if (!this.msnry) {\n                    this.initMasonry();\n                }\n                this.quicklayout();\n            }.bind(this)\n        );\n        imgLoad.on(\n            \"always\",\n            function () {\n                if (!this.msnry) {\n                    this.initMasonry();\n                }\n                this.layout();\n            }.bind(this)\n        );\n\n        // Update if something gets injected inside the pat-masonry\n        this.$el\n            .on(\n                \"patterns-injected.pat-masonry\",\n                utils.debounce(this.update.bind(this), 100)\n            )\n            .on(\"pat-update\", utils.debounce(this.quicklayout.bind(this), 200));\n\n        var callback = utils.debounce(this.quicklayout.bind(this), 400);\n        var observer = new MutationObserver(callback);\n        /* Explicitly not including style. We assume style is set dynamically only by scripts and we do all our controlled changes through classes.\n           That way we avoid masonry to react on its own style calculation */\n        var config = {\n            childList: true,\n            subtree: true,\n            characterData: false,\n            attributeOldValue: true,\n            attributes: true,\n            attributeFilter: [\"class\"],\n        };\n        observer.observe(document.body, config);\n    },\n\n    async initMasonry() {\n        var containerStyle;\n        try {\n            containerStyle = JSON.parse(this.options.containerStyle);\n        } catch (e) {\n            containerStyle = { position: \"relative\" };\n            log.warn(\n                \"Invalid value passed in as containerStyle. Needs to \" +\n                    \"be valid JSON so that it can be converted to an object for Masonry.\"\n            );\n        }\n        this.msnry = new Masonry(this.$el[0], {\n            columnWidth: this.getTypeCastedValue(this.options.columnWidth),\n            containerStyle: containerStyle,\n            fitWidth: this.options.is[\"fit-width\"],\n            gutter: this.getTypeCastedValue(this.options.gutter),\n            horizontalOrder: this.options.is[\"horizontal-order\"],\n            initLayout: false,\n            itemSelector: this.options.itemSelector,\n            originLeft: this.options.is[\"origin-left\"],\n            originTop: this.options.is[\"origin-top\"],\n            percentPosition: this.options.is[\"percent-position\"],\n            resize: this.options.is[\"resize\"],\n            stamp: this.options.stamp,\n            transitionDuration: this.options.transitionDuration,\n        });\n    },\n\n    update: function () {\n        this.msnry.remove();\n        this.initMasonry();\n        this.layout();\n    },\n\n    quicklayout: function () {\n        if (!this.msnry) {\n            // Not initialized yet\n            return;\n        }\n        // call masonry layout on the children before calling it on this element\n        this.$el.find(\".pat-masonry\").each(function (idx, child) {\n            $(child).patMasonry(\"quicklayout\");\n        });\n        this.msnry.layout();\n    },\n\n    layout: function () {\n        this.$el.removeClass(\"masonry-ready\");\n        this.msnry.on(\n            \"layoutComplete\",\n            function () {\n                this.$el.addClass(\"masonry-ready\");\n            }.bind(this)\n        );\n        this.msnry.layout();\n        this.quicklayout();\n    },\n\n    getTypeCastedValue: function (original) {\n        var val = Number(original);\n        return isNaN(val) ? original || 0 : val;\n    },\n});\n"],"names":["logger","logging","getLogger","DATA_PREFIX","DATA_STYLE_DISPLAY","get_css_value","el","property","as_pixels","as_float","value","window","getComputedStyle","getPropertyValue","parseFloat","parseInt","Math","round","get_relative_position","reference_el","document","body","left","abs","getBoundingClientRect","scrollLeft","dom","top","scrollTop","get_data","name","default_value","set_data","toNodeArray","nodes","jquery","NodeList","Array","querySelectorAllAndMe","selector","all","querySelectorAll","matches","unshift","wrap","wrapper","parentNode","insertBefore","appendChild","hide","style","display","show","val","find_parents","ret","parent","closest","push","find_scoped","indexOf","get_parents","parents","HTMLElement","acquire_attribute","attribute","include_empty","include_all","_el","getAttribute","parentElement","is_visible","offsetWidth","offsetHeight","is_input","test","nodeName","create_from_string","string","createRange","createContextualFragment","trim","find_scroll_container","direction","fallback","overflow_y","includes","overflow_x","get_scroll_x","scroll_reference","scrollX","get_scroll_y","scrollY","scroll_to_element","scroll_container","offset","position","options","behavior","scrollTo","scroll_to_top","scroll_to_bottom","scrollHeight","delete_data","template","template_string","template_variables","warn","Function","call","get_visible_ratio","container","rect","container_rect","bottom","innerHeight","visible_ratio","rect_height","min","max","escape_css_id","id","CSS","escape","split","element_uuid","uuid","crypto","randomUUID","array","Uint32Array","getRandomValues","join","find_form","form","querySelector","root","writer","prototype","bind","oThis","this","TypeError","aArgs","slice","arguments","fToBind","fNOP","fBound","apply","concat","Level","DEBUG","INFO","WARN","ERROR","FATAL","ConsoleWriter","Logger","_loggers","_parent","_enabled","_level","setWriter","w","output","log_name","level","messages","console","log","info","error","path","route","length","entry","shift","_getFlag","flag","context","undefined","setEnabled","state","isEnabled","setLevel","toUpperCase","getLevel","debug","fatal","match","logconfig","exec","location","search","getWriter","disable_re","dont_catch_re","disabled","dont_catch","__patternslib_registry","PATTERN_REGISTRY","__patternslib_registry_initialized","registry","patterns","init","$","ready","Object","keys","sort","scan","clear","transformPattern","content","pattern","transform","e","initPattern","trigger","$el","plog","orderPatterns","splice","Text","selectors","map","it","replace","filter","reverse","classList","add","register","jquery_plugin","plugin_name","p1","utils","jqueryPlugin","safeClone","clone","forEach","callback","thisArg","T","k","O","len","kValue","singleBoundJQueryPlugin","method","each","pat","charAt","pluralBoundJQueryPlugin","$this","isObject","obj","type","regexp_from_wildcard","wildcard","regexp","RegExp","isElementInViewport","partial","rec","right","every","documentElement","clientHeight","innerWidth","clientWidth","escapeRegExp","str","extend","source","prop","i","hasOwnProperty","findLabel","input","$label","label","nodeType","tagName","removeWildcardClass","targets","classes","ensureArray","target","remove","matcher","class_list","ok","setAttribute","removeAttribute","hideOrShow","visible","pattern_name","transitions","none","fade","slide","duration","transition","effect","on_complete","action","t","easing","complete","addURLQueryParameter","fullURL","param","parts","toString","url","hash","newURL","removeDuplicateObjects","objs","comparator","v","reduce","list","next_obj","is_duplicate","entries","mergeStack","stack","results","frame","frame_length","x","hasValue","checked","selectedIndex","parseTime","time","m","Error","amount","parseLength","reference_length","findRelatives","$relatives","$form","find","get_bounds","bounds","y","width","height","checkInputSupport","invalid_value","support","createElement","checkCSSFeature","tag","supported","animation_frame","Promise","requestAnimationFrame","timeout","ms","resolve","setTimeout","debounce","func","timer","postpone","last_run","args","Date","now","clearTimeout","isIE","documentMode","jqToNode","force_array","isPrototypeOf","isArray","localized_isodate","date","day","getDate","padStart","month","getMonth","getFullYear","escape_html","html","createTextNode","innerHTML","unescape_html","escaped_html","DOMParser","parseFromString","textContent","is_iso_date_time","optional_time","is_iso_date","date_diff","date_1","date_2","utc_1","UTC","utc_2","floor","threshold_list","num_steps","thresholds","is_option_truthy","option","elementInViewport","ArgumentParser","constructor","order","parameters","enum_values","enum_conflicts","groups","possible_groups","group_pattern","json_param_pattern","named_param_pattern","token_pattern","_camelCase","__","addAlias","alias","original","addGroupToSpec","spec","group","field","first_spec","first_name","dest","addArgument","choices","multiple","addJSONArgument","_typeof","choice","_coerce","JSON","parse","toLowerCase","num","isNaN","_set","opts","part","_split","text","tokens","quoted","simple","_parseExtendedNotation","argstring","arg","values","subopt","_parseShorthandNotation","parameter","sense","positional","_parse","sep","extended","_defaults","result","_cleanupOptions","group_options","inherit","$possible_config_providers","final_length","hasClass","addBack","provider","data","attr","current_value","add_argument","getOptions","patternName","elOptions","tmpOptions","item","key","pop","initBasePattern","Registry","parser","mockupParser","Base","async","defaults","emit","on","eventName","eventCallback","one","patternProps","child","Surrogate","__super__","autoregister","Masonry","Parser","default","ImagesLoaded","initMasonry","imgLoad","msnry","quicklayout","layout","update","MutationObserver","observe","childList","subtree","characterData","attributeOldValue","attributes","attributeFilter","containerStyle","columnWidth","getTypeCastedValue","fitWidth","is","gutter","horizontalOrder","initLayout","itemSelector","originLeft","originTop","percentPosition","resize","stamp","transitionDuration","idx","patMasonry","removeClass","addClass","Number"],"sourceRoot":""}