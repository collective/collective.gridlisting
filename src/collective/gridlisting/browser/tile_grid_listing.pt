<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      lang="en"
      xml:lang="en"
      i18n:domain="plone"
>
    <body tal:define="original_context nocall:options/original_context|context;">
        <div tal:define="
                batch context;
                portal original_context/@@plone_portal_state/portal;
                normalizeString nocall:portal/@@plone/normalizeString;
                toLocalizedTime nocall:portal/@@plone/toLocalizedTime;
                registry original_context/portal_registry;
                use_view_action python: registry.get('plone.types_use_view_action_in_listings', []);
                image_scale portal/@@image_scale;
                col_class original_context/column_css_class;
                col_content_class original_context/column_content_css_class|nothing;
                col_content_txt_class original_context/column_content_text_css_class|string:col;
                col_content_img_class original_context/column_content_image_css_class|string:col-3 text-end;
                thumb_scale_summary original_context/preview_scale|thumb_scale_summary|string:preview;
                item_title_tag original_context/item_title_tag"
            class="row ${original_context/row_css_class} ${python:'pat-masonry' if original_context.enable_masonry else ''}"
            data-pat-masonry="item-selector: article; ${original_context/masonry_options|string:}">
            <tal:repeat metal:define-macro="entries" repeat="item python:batch">
                <tal:block tal:define="
                        obj python:item.getObject();
                        item_url python:item.getURL();
                        item_id python:item.getId();
                        item_title python:item.Title();
                        item_title python:item_title or item_id;
                        item_description python:item.Description();
                        item_type python:item.PortalType();
                        item_modified python:item.ModificationDate();
                        item_created python:item.CreationDate();
                        item_wf_state python:item.review_state();
                        item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                        item_creator python:item.Creator();
                        item_link python:item_type in use_view_action and item_url+'/view' or item_url;
                        item_is_event python:item.portal_type == 'Event';
                        item_has_image python:item.getIcon;
                        item_type_class python:('contenttype-' + normalizeString(item_type));
                    ">
                    <metal:block define-slot="entry">

                        <article class="${col_class}">
                            <div class="${col_content_class}" metal:define-macro="listitem">

                                <div class="${col_content_txt_class}">

                                    <div class="mb-1">
                                        <tal:block replace="structure string:&lt;${item_title_tag}&gt;" />
                                        <a tal:content="python:item_title" tal:attributes="
                                                href python:item_link;
                                                class string:$item_type_class $item_wf_state_class url;
                                                title item_type;
                                                ">
                                            Item Title
                                        </a>
                                        <tal:block replace="structure string:&lt;/${item_title_tag}&gt;" />
                                    </div>

                                    <metal:block metal:define-macro="document_byline">
                                        <div class="mb-1 document-byline">

                                            <tal:event condition="python:item_is_event">
                                                <tal:date tal:replace="structure python:toLocalizedTime(item.start)" />
                                                <span tal:condition="python:obj.location"
                                                    i18n:translate="label_event_byline_location">
                                                    &mdash;
                                                    <span class="location" tal:content="python:obj.location"
                                                        i18n:name="location">Oslo</span>
                                                </span>
                                                &mdash;
                                            </tal:event>

                                        </div>
                                    </metal:block>

                                    <p class="me-3" tal:condition="python:item_description"
                                        tal:content="python:item_description">
                                        description
                                    </p>
                                </div>
                                <div class="${col_content_img_class}"
                                    tal:condition="python:item_has_image and thumb_scale_summary">
                                    <a href="${item_link}">
                                        <img
                                            tal:replace="structure python:image_scale.tag(item, 'image', scale=thumb_scale_summary, loading='lazy')" />
                                    </a>
                                </div>
                            </div>

                        </article>

                    </metal:block>
                </tal:block>
            </tal:repeat>
        </div>
        <div metal:use-macro="original_context/batch_macros/macros/navigation"></div>
    </body>
</html>
